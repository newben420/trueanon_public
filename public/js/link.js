var temp_name="";function createTemporary(){jp.prompt({title:"Please enter your name (required)",inputType:"text",maxLength:50,value:temp_name,cancel:!0,required:!0,callback:function(e){if(e.stat){var a=[],s=e.res.replace(/\s{2,}/g," ").trim();if(/^((\s+)?((?=.*[a-z])[a-z\d_\-']{1,})(\s+)?((?=.*[a-z])[a-z\d_\-']{1,})?(\s+)?((?=.*[a-z])[a-z\d_\-']{1,})?(\s+)?){1,50}$/i.test(e.res)||a.push("Name requires at least one alphabet, no special characters other than _,', and -, and a maximum of three separate names or 50 characters."),a.length>0)temp_name=e.res,jp.destroyAll(),createTemporary(),jp.err(a.join("<br><br>"));else{var r=function(e){jp.prompt({title:'Please choose a password <small class="inst"><strong>ins:</strong>Password must be at least 8 chars long, must contain at least one uppercase, one lowercase, one number and one symbol.</small>',inputType:"password",maxLength:30,cancel:!0,required:!0,callback:function(a){if(a.stat){var s=a.res,n=[];/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/.test(s)||n.push("Invalid Password! Please follow instructions."),n.length>0?(jp.destroyAll(),r(e),jp.err(n.join("<br><br>"))):($("#preloader").show(),socket.emit("create_temporary_link_09u8ydft5gy4u8",e,s,(function(a){if(a.succ){$("#preloader").hide();var r=a.message,n=a.u,t=a.i,o=e,i=a.b,l=`<p class="text blackxxx">Congratulations ${o},<br/>\n                                                Your link has been successfully generated. Copy to clipboard or share below:</p>\n                                                <div id="inx">\n                                                    <input readonly value="${n+"/"+r}"/>\n                                                    <button data-name="${o}" onclick="copyToClip(this)">Copy</button>\n                                                </div>\n                                                <div id="sharex-page">\n                                               <div data-a2a-url="${n+'/'+r}"  data-a2a-title="Send an Anonymous Message to ${o} on ${i}" class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_dd" href="https://www.addtoany.com/share"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_whatsapp"></a><a class="a2a_button_pinterest"></a></div>                                                </div>\n                                                <div class="hr"></div>\n                                                <button onclick="showLogInfo(this)" data-id="${r}" data-pass="${s}" class="solid-btnx">Manage Your Messages</button>\n                                                \n                                                `;jp.succ(l);ats()}else $("#preloader").hide(),a.message?jp.err(a.message):jp.err("An unknown error was encountered! Please try again...")})))}}})};r(s)}}}})}function showLogInfo(e){var a=`your login details are: <br/><br/>User ID: <strong>${$(e).attr("data-id")}</strong><br/>Password: <strong>${$(e).attr("data-pass")}</strong>\n    \n    <br/><br>Please store these details securely.<br/>To login, click on "Manage Messages" from the main navigation (menu).`;jp.info(a)}function copyToClip(e){try{var a=e.previousElementSibling;a.select(),a.setSelectionRange(0,99999),navigator.clipboard.writeText("Would you like to send me an anonymous message? visit "+a.value+" and express yourself... I will never know who sent it."),$(e).text("Copied")}catch(a){$(e).text("Copy"),jp.err("Copy Failed!")}}function mcou(e){var a=e.value.length;$("#mcou").text(a),a>500?$("#mcou").parent().addClass("mcfill"):$("#mcou").parent().removeClass("mcfill")}function sendMessage(e,a){var s=$("#mess").val();if(""!=s.replace(/[\s\n\t]/g,"")&&/^\d\d\d\d\d\d$/.test(e)){var r=s.replace(/ +/g," ").replace(/[\t]+/g," ").replace(/\n\s*\n/g,"\n");$("#preloader").show(),socket.emit("send_message_0e9rufgfy4u833ejhd",e,a,r,(function(e){if(e.succ){$("#preloader").hide();jp.succ('Message sent anonymously!<br><br> Would you want a link like this to receive anonymous messages too? <a class="greenx" href="/create-link">Click here, it\'s free, quick and easy.</a>'),$("#mess").val("")}else $("#preloader").hide(),e.message?jp.err(e.message):jp.err("An unknown error was encountered! Please try again...")}))}else jp.err("You cannont send an empty anonymous message")}function login(){var e=$("#logid").val().trim(),a=$("#logpw").val().trim(),s=0;$("#logrm")[0].checked&&(s=1);var r=[];""!=e&&""!=a||r.push("User ID and Password are both required"),""==e||/^\d\d\d\d\d\d$/.test(e)||r.push("Invalid User ID"),r.length>0?jp.err(r.join(".<br/><br/>")):($("#preloader").show(),$.ajax({type:"post",url:"/manage-messages",data:{id:e,pw:a,rm:s,_csrf:csrfx},headers:{"x-csrf-token":csrfx},error:()=>{$("#preloader").hide(),jp.err("A connection could not be established. Please check your internet connection status and try again.")},success:e=>{e.succ?window.location.href="":($("#preloader").hide(),e.message?jp.err(e.message):jp.err("An unknown error was encountered! Please try again..."))}}))}
