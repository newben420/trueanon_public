$(document).ready((function(){load_user()}));var sch=!1;function load_user(e=1){if(0!=sch){var s='<p class="form-ins text-center grey"><i class="fa-solid fa-spinner fa-pulse"></i> Loading search results... Please wait.</p>';$("#messages").html(s)}else{s='<p class="form-ins text-center grey"><i class="fa-solid fa-spinner fa-pulse"></i> Loading anonymous messages... Please wait.</p>';$("#messages").html(s)}2==e&&(sch=!1,$("#preloader").show()),socket.emit("load_user_0ei9uy3",sch,(function(s){if(2==e&&$("#preloader").hide(),s.err)s.message?jp.err(s.message):jp.err("Data could not be loaded... Please manually refresh page if problem persists.");else if(s.succ){var t,r=[],o=s.message,a=0,n=o.length,l="";for(t=0;t<n;t++){var i=o[t],c='<div class="message">';0==i.seen_status&&(c+="<small>New</small>",r.push(i.id),a++),l+=c+=`<span>Anonymous . ${i.date_created}</span>\n                            <p>${entities(i.message)}</p>\n                            <div class="text-right"><button onclick="deleteMess(${i.id})" class="light-btn reddy mt10"><i class="fa solid fa-trash"></i> </button></div>\n                        </div>`}if(0==n)if(0!=sch){/[^a-z0-9]/gi.test(sch)?jp.info("No results found! It is advisable to avoid using symbols in your search input for better response."):jp.info("No results found! Please try another keyword.");var u="<p class=\"form-ins text-center grey\"> No results found... You can click 'Refresh' to exit Search View.</p>";$("#messages").html(u)}else{u='<p class="form-ins text-center grey"> No anonymous messages received.</p>';$("#newmess").html(0),$("#totmess").html(0),$("#messages").html(u)}else 0!=sch?(l=`<p class="form-ins text-center grey">Search Results (${n}), you can click 'Refresh' to exit Search View.</p>`+l,$("#messages").html(l)):($("#newmess").html(a),$("#totmess").html(n),$("#messages").html(l));r.length>0&&socket.emit("update_seen_status_W0e9r84y",r.join(","))}else s.info&&jp.info(s.message)}))}function news(){jp.info("Get real-time email notifications for new anonymous messages when you sign up for our newsletters... Coming soon!")}function deleteMess(e){jp.confirm("Are you sure you want to permanently delete this message?",(s=>{s&&socket.emit("del_message_fjhefijer",e,(e=>{e.succ?(jp.succ("Deletion successful!"),load_user()):jp.err("Deletion failed!")}))}))}function searchfx(){jp.prompt({title:'Search <small class="inst">Please type and click on Submit to search. Input is required.</small>',inputType:"text",maxLength:100,cancel:!0,required:!0,callback:function(e){e.stat&&(sch=e.res,load_user())}})}function changepw(){var e=function(s){jp.prompt({title:'Please choose a new password <small class="inst"><strong>ins:</strong>Password must be at least 8 chars long, must contain at least one uppercase, one lowercase, one number and one symbol.</small>',inputType:"password",maxLength:30,cancel:!0,required:!0,callback:function(s){if(s.stat){var t=s.res,r=[];if(/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/.test(t)||r.push("Invalid Password! Please follow instructions."),r.length>0)jp.destroyAll(),e(),jp.err(r.join("<br><br>"));else{o=t,jp.prompt({title:"Repeat/Confirm new password",inputType:"password",maxLength:30,cancel:!0,required:!0,callback:function(e){if(e.stat){var s=e.res,t=[];if(/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/.test(s)||t.push("Wrong Password!"),t.length>0)jp.destroyAll(),r(o),jp.err(t.join("<br><br>"));else if(o!=s)jp.err("Passwords do not match.");else{var r=function(e){jp.prompt({title:"Type in your current password",inputType:"password",maxLength:30,cancel:!0,required:!0,callback:function(s){if(s.stat){var t=s.res,o=[];/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/.test(t)||o.push("Wrong Password!"),o.length>0?(jp.destroyAll(),r(e),jp.err(o.join("<br><br>"))):e==t?jp.info("Password not updated."):($("#preloader").show(),socket.emit("change_password_iurfuudwi",e,t,(function(e){e.succ?($("#preloader").hide(),jp.succ("Password changed successfully.")):($("#preloader").hide(),e.message?jp.err(e.message):jp.err("An unknown error was encountered! Please try again..."))})))}}})};r(s)}}}})}}var o}})};e()}function logout(){jp.confirm("Are you sure you want to logout?",(function(e){e&&($("#preloader").show(),window.location.href="/logout")}))}function deletelink(){jp.confirm("Are you sure you want to permanently delete this link? <br/><br/><small class='inst redx'><strong>You will not be able to log back into your account and access your messages.</strong></small>",(function(e){if(e){var s=function(){jp.prompt({title:"Type in your password to confirm deletion",inputType:"password",maxLength:30,cancel:!0,required:!0,callback:function(e){if(e.stat){var t=e.res,r=[];/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/.test(t)||r.push("Wrong Password!"),r.length>0?(jp.destroyAll(),s(),jp.err(r.join("<br><br>"))):($("#preloader").show(),socket.emit("delete_link_e08ryty7fr8909r8euy",t,(e=>{e.succ?window.location.href="/logout":($("#preloader").hide(),req.message&&jp.err(req.message),jp.err("An unknown error was encountered."))})))}}})};s()}}))}